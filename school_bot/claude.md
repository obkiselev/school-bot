# Инструкции для Claude в рамках проекта School Bot

## 1. Перед началом любой работы обязательно прочитай актуальное состояние проекта:
- Открой файл `PROGRESS.md` и проверь/обнови текущий прогресс по задачам и фазам.
- Ориентируйся на текущую фазу разработки при выполнении задач.
- Не GIT пушить ни куда.

## 2. Перед завершением любой сессии обязательно обнови:
- Текущую версию проекта определяй по `PROGRESS.md`
- Увеличивай последнюю minor: 0.1.0 -> 0.1.1, без смены нумерации
- Обнови файлы:
  - `PROGRESS.md` — перенести завершённые задачи из "в планах" в завершённые, обновить changelog.
  - `README.md` — обновить номер версии, добавить новый функционал и прогресс по фазам разработки.
  - Другие файлы, в которых указана текущая версия.
- Git-операции:
  - `git add PROGRESS.md README.md` (и другие изменённые файлы)
  - `git commit -m "vX.Y.Z: краткое описание изменений"`
  - `git tag vX.Y.Z`
  - `git push origin main --tags`

В результате проект постоянно имеет актуальную документацию и удобную историю для отслеживания прогресса. Обновление/дополнение инструкций должно происходить через явное согласование.

## О проекте

- **Название**: School Bot — Telegram-бот для МЭШ
- **Язык**: Python 3.9+
- **Фреймворк**: aiogram 3.25 (асинхронный)
- **БД**: SQLite через aiosqlite
- **Конфигурация**: pydantic-settings + .env
- **Шифрование**: cryptography (Fernet)

## Структура проекта

```
school_bot/
├── bot.py              # Точка входа
├── config.py           # Настройки (pydantic-settings)
├── core/               # database.py, encryption.py
├── mesh_api/           # auth.py, client.py, endpoints.py, models.py, exceptions.py
├── handlers/           # start.py, registration.py, schedule.py
├── keyboards/          # Клавиатуры (в планах)
├── states/             # FSM states (registration.py)
├── database/           # crud.py, migrations/init.sql
├── notifications/      # Уведомления (в планах)
├── utils/              # token_manager.py
├── tests/              # test_schedule.py, conftest.py
└── data/               # SQLite БД, логи
```

## Важные детали

- Пароли МЭШ хранятся зашифрованными (Fernet), ключ в .env
- FSM используется для пошаговой регистрации
- МЭШ API неофициальное — может сломаться
- Rate limit: не более 30 запросов/мин к МЭШ API
